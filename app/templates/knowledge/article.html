{% extends "layout/base.html" %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div class="mb-4">
        <a href="/knowledge" class="btn btn-secondary text-sm">‚Üê Back to Knowledge Base</a>
    </div>

    <div class="card">
        <div class="flex justify-between items-start mb-4">
            <h1 class="mb-2">{{ article.title }}</h1>
            {% if user %}
            <a href="/knowledge/{{ article.id }}/edit" class="btn btn-secondary text-sm">Edit</a>
            {% endif %}
        </div>
        
        <div class="flex gap-4 text-sm text-gray mb-6">
            <span>Category: {{ article.category|replace('_', ' ')|title }}</span>
            <span>‚Ä¢</span>
            <span>Views: {{ article.views }}</span>
            <span>‚Ä¢</span>
            <span>Updated: {{ article.updated_at.strftime('%Y-%m-%d') }}</span>
        </div>
        
        <div id="content-markdown" style="display:none;">{{ article.content }}</div>
        <div id="content-display" class="prose mb-8" style="line-height: 1.6;"></div>
        
        <hr style="border: 0; border-top: 1px solid var(--border); margin: 2rem 0;">
        
        <div class="flex items-center gap-4">
            <span class="text-gray">Was this article helpful?</span>
            <form action="/knowledge/{{ article.id }}/vote" method="post" style="display:inline;">
                <button type="submit" class="btn btn-secondary text-sm">üëç Yes ({{ article.helpful_votes }})</button>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const rawContent = document.getElementById('content-markdown').textContent;
        document.getElementById('content-display').innerHTML = marked.parse(rawContent);
    });
</script>
{% endblock %}
